# ---

**気象検定3級アプリ 開発仕様書（Ver 2.0）**

## **1\. プロジェクト概要**

* **目的:** 気象検定3級の模擬試験を実施できるアプリの開発  
* **プラットフォーム:** Webアプリ（PC/SPブラウザ対応）および iPhoneアプリ（iOS）  
* **ターゲット:** 気象検定3級受験者

## **2\. 開発ワークフレーム・技術スタック**

WebとiOSアプリを単一のコードベースで効率的に開発するため、以下の構成を採用します。

| 区分 | 技術選定 | 選定理由 |
| :---- | :---- | :---- |
| **フロントエンド** | **Next.js (React)** | 高速なWeb動作とモダンなUI構築に最適。Vercelとの親和性が高い。 |
| **モバイル化** | **Capacitor** | Next.jsで作ったWebアプリをそのままラップしてiOSアプリ化できる。 |
| **バックエンド** | **Supabase** | 認証、DB、APIが即座に用意でき、開発工数を大幅に削減可能。 |
| **ホスティング** | **Vercel** | Web版の公開用。GitHub連携で自動デプロイが可能。 |
| **UIフレームワーク** | **Tailwind CSS** | 素早くレスポンシブデザイン（PC/スマホ両対応）を構築できる。 |

## ---

**3\. 機能要件**

### **A. 出題ロジック（重要変更点）**

問題データベースからランダムにピックアップし、以下の順序と配分で**合計100問**を出題します。

1. **知識:** ランダム **50問**  
2. **防災:** ランダム **25問**  
3. **生活:** ランダム **15問**  
4. **文化:** ランダム **10問**

※ 合計100問。各カテゴリ内で出題順はランダムですが、カテゴリの並び順（知識→防災→生活→文化）は固定します。

### **B. 画面遷移と詳細仕様**

#### **1\. トップ画面 (Home)**

* **表示要素:**  
  * アプリタイトルロゴ「気象検定3級 模擬試験」  
  * **試験開始ボタン:** 「試験を開始する」  
  * **ランキング（リーダーボード）:**  
    * 試験実施者の「名前」「得点」「実施日」をリスト表示。  
    * 上位10件または最新20件を表示（スクロール可）。  
* **動作:** 開始ボタン押下で「試験前画面」へ遷移。

#### **2\. 試験前画面 (Pre-Exam)**

* **表示要素:**  
  * 試験概要説明：「試験時間60分、全100問（知識50/防災25/生活15/文化10）」  
  * 注意事項：「途中保存はできません」など  
  * **スタートボタン:** 「試験を始める」  
* **動作:** スタートボタン押下で試験開始（タイマー作動）。

#### **3\. 試験中画面 (Exam)**

* **ヘッダー:**  
  * **残り時間:** 60:00 からのカウントダウン（0になると強制終了）。  
  * **進捗:** 現在の問題番号 / 全100問（例: 15/100）  
  * **現在カテゴリ:** 「知識編」などを表示。  
* **問題エリア:**  
  * 問題文  
  * 選択肢（A, B, C, D）のラジオボタンまたはカード型ボタン。  
* **フッター:**  
  * 「戻る」ボタン（1問目では非活性）  
  * 「次へ」ボタン（選択するまで非活性にするか、未選択でも進めるかは要検討。今回は「選択して次へ」を推奨）  
  * **最終問題時:** 「次へ」が「解答終了」ボタンに変化。  
* **仕様:** \* 解答は一時的にローカル（メモリ内）に保存。  
  * 未回答がある状態で終了ボタンを押した場合、アラート（警告）を出す。

#### **4\. 結果・解説画面 (Result)**

* **スコア表示:**  
  * 得点（◯◯点 / 100点）  
  * 合否判定（70点以上：**「合格」**、70点未満：**「不合格」**）  
  * 合格時は「おめでとうございます！」などの演出（紙吹雪アニメーション等）。  
* **正解・解説リスト:**  
  * 1問目から100問目までをリスト表示。  
  * 各カードに「問題文」「あなたの回答」「正解」「解説」を表示。  
  * 不正解の問題は背景色を変えるなどして目立たせる。  
* **結果登録:**  
  * 画面下部に「名前を入力して終了」エリア。  
  * 名前入力欄 ＋ 「登録してトップへ戻る」ボタン。  
* **動作:** 登録ボタン押下でSupabaseにデータ送信し、トップ画面へ戻る。

## ---

**4\. データベース設計 (Supabase)**

### **テーブル1: questions (問題マスタ)**

CSVデータをインポートします。

* id (int8, Primary Key)  
* category (text) : '知識', '防災', '生活', '文化'  
* question (text) : 問題文  
* option\_a (text)  
* option\_b (text)  
* option\_c (text)  
* option\_d (text)  
* correct\_answer (text) : 'A', 'B', 'C', 'D'  
* explanation (text) : 解説

### **テーブル2: exam\_results (成績データ)**

* id (uuid, Primary Key)  
* user\_name (text) : 受験者名  
* score (int2) : 得点  
* details (jsonb) : 詳細データ（どの問題を間違えたか等のログ保存用、任意）  
* created\_at (timestamptz) : 受験日時

## ---

**5\. 実装に向けたコードイメージ（更新版）**

新しい配分に対応するための、問題抽出ロジック（JavaScript/TypeScript）のイメージです。

JavaScript

// utils/examGenerator.js

export const generateExamQuestions \= (allQuestions) \=\> {  
  // 1\. カテゴリごとにデータを分割  
  const knowledge \= allQuestions.filter(q \=\> q.category \=== '知識');  
  const disaster \= allQuestions.filter(q \=\> q.category \=== '防災');  
  const life \= allQuestions.filter(q \=\> q.category \=== '生活');  
  const culture \= allQuestions.filter(q \=\> q.category \=== '文化');

  // 2\. シャッフル関数  
  const shuffle \= (array) \=\> array.sort(() \=\> Math.random() \- 0.5);

  // 3\. 規定数ピックアップして結合  
  // 配分: 知識50, 防災25, 生活15, 文化10  
  const examSet \= \[  
    ...shuffle(knowledge).slice(0, 50),  
    ...shuffle(disaster).slice(0, 25),  
    ...shuffle(life).slice(0, 15),  
    ...shuffle(culture).slice(0, 10),  
  \];

  return examSet; // 合計100問の配列  
};

## **6\. 開発フロー**

1. **環境構築:**  
   * Node.jsインストール  
   * npx create-next-app@latest でプロジェクト作成  
   * Supabaseプロジェクト作成とAPIキー取得  
2. **DB準備:**  
   * SupabaseのTable EditorでCSVをインポート  
3. **アプリ実装:**  
   * トップ画面、試験画面、結果画面のコンポーネント作成  
   * 出題ロジックの実装  
4. **Webデプロイ:**  
   * Vercelへデプロイして動作確認  
5. **アプリ化:**  
   * npm install @capacitor/ios  
   * npx cap add ios  
   * Xcodeでビルドして実機テスト

この設計で進めれば、ご希望の機能を備えたアプリがスムーズに作成可能です。